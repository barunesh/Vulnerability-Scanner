#!/usr/bin/env python

import scanner
import optparse

def get_url():
    parser = optparse.OptionParser()
    parser.add_option("-u", "--url", dest="target_url",help="Used to specify the Target URL")
    (options, arguments) = parser.parse_args()
    if not options.target_url:
        parser.error("[-] Please specify the Target URL, use --help for more info.")
    return options.target_url

target_url = get_url()
links_to_ignore = target_url +"logout.php"
data_dict = {"username" : "admin", "password" : "password", "Login" : "submit"}
vuln_scanner = scanner.Scanner(target_url, links_to_ignore)
session_link = target_url + "login.php"
vuln_scanner.session.post(session_link, data=data_dict)

vuln_scanner.crawl()
vuln_scanner.run_scanner()

